<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Home</title>

  <!-- Favicon -->
  <link rel="icon" href="/assets/favicon.png" type="image/png">

  <!-- Google Fonts for Amiri -->
  <link href="https://fonts.googleapis.com/css2?family=Amiri&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Antic+Didone&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Gruppo&display=swap" rel="stylesheet">


  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    html, body {
        overflow-x: hidden; /* Prevents horizontal scrolling */
        width: 100vw; /* Sets the width to viewport width */
        margin: 0; /* Ensures no extra space */
    }
    body {
      font-family: 'Amiri', serif;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      background-color: #FFFFFF;
      overflow-x: hidden;
    }

    /* Warning Message for Desktop Users */
    .desktop-warning {
      display: none;
      text-align: center;
      color: #333;
      font-size: 3vw;
      font-family: 'Amiri', serif;
      position: fixed;
      top: 40vh;
      width: 100vw;
      text-align: center;
    }

    /* Main Container for Mobile Layout */
    .mobile-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      width: 100vw;
      max-width: 600px;
    }
    .logo {
      position: fixed;
      top: 6vh;
      left: 6vw;
      width: 18.6vw;
      max-width: 100px;
      z-index: 1000;
    }

    .arrow {
      position: fixed;
      bottom: 13vh;
      right: 11vw;
      width: 6vw;
      max-width: 100px;
      z-index: 1000;
    }

    .photo {
      position: absolute;
      width: 42vw;
      height: 59.46vw;
      top: -35vh;
      left: 29vw;
      z-index: 9;
      object-fit: cover;
      object-position: center;
    }

    .date {
      position: absolute;
      z-index: 9;
      top: -34vh;
      left: -31vw;
      width: 84vw;
      font-family: "Antic Didone", serif;
      font-weight: 400;
      font-style: normal;
      line-height: 5vw;
      color: #0F0F0F;
      text-align: center;
    }

    .date .day {
        font-size: 7vw;
        -webkit-text-stroke: 0.2vw black;
    }
    .date .month {
        font-size: 4vw;
        letter-spacing: 0.05em;
    }
    .resultimage1 {
      position: fixed;
      top: 66vh;
      width: 33vw;
      height: 36.91vw;
      left: 7vw;
      z-index: 2;
    }
    .resultimage1 .icon-img {
      width: 33vw;
    }
    .resultimage2 .icon-img {
      width: 33vw;
    }

    .resultimage2 {
      position: fixed;
      top: 66vh;
      width: 33vw;
      left: 42vw;
      z-index: 2;
      height: 36.91vw;
    }

    .resultimage1 .t100 {
      position: absolute;
      bottom: 2vw;
      width: 11vw;
      right: 2vw;
      z-index: 3;
    }

    .resultimage2 .t50 {
      position: absolute;
      bottom: 2.2vw;
      width: 9vw;
      right: 2.8vw;
      z-index: 3;
    }

    .analysis-result {
      position: fixed;
      top: 57vh;
      width: 84vw;
      left: 8vw;
      font-size: 4vw;
      color: #333;
      text-align: left;
      z-index: 2;
      line-height: 4vw;
    }

    .outfitNum {
      position: fixed;
      top: 51vh;
      width: 80vw;
      left: 8vw;
      color: #333;
      text-align: left;
      font-family: 'Antic Didone', serif;
      font-size: 7vw;
      z-index: 2;
    }

    
    .fade-in-bg {
      animation: fadeInBg 3s ease forwards;
    }

    .fade-out-bg {
      animation: fadeOutBg 5s ease forwards;
    }

    .pulsing {
      animation: pulse 3s ease-in-out infinite;
      transform-origin: left;
    }

    @keyframes pulse {
      0% {
        opacity: 0.5;
        transform: scale(1);
      }
      50% {
        opacity: 1;
        transform: scale(1.05); /* Slightly enlarges for a 'breathing' effect */
      }
      100% {
        opacity: 0.5;
        transform: scale(1);
      }
    }

    @keyframes fadeInBg {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    @keyframes fadeOutBg {
      0% {
        opacity: 1;
      }
      50% {
        opacity: 1; /* Slower fade-out for the first half */
      }
      100% {
        opacity: 0; /* Faster fade-out in the later half */
      }
    }

    /* Fade In Animation */
    .fade-in {
      animation: fadeIn 1s ease forwards;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    /* Slide In (from Right to Left) Animation */
    .side-slide-in {
      animation: sideslideIn 0.8s ease forwards;
    }

    @keyframes sideslideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    /* Slide Out (from Left to Right) Animation */
    .side-slide-out {
      animation: sideslideOut 0.8s ease forwards;
    }

    @keyframes sideslideOut {
      from {
        transform: translateX(0);
        opacity: 1;
      }
      to {
        transform: translateX(100%);
        opacity: 0;
      }
    }

    /* Emerge Animation */
    .emerge {
      animation: emerge 1s ease forwards;
    }

    @keyframes emerge {
      from {
        transform: scale(0.8);
        opacity: 0;
      }
      to {
        transform: scale(1);
        opacity: 1;
      }
    }

    .slide-in {
        opacity: 0;
        animation: slidein 1s ease forwards;
        transform: translateY(10px); /* Starting point for slide-in */
        /* transition: opacity 1.5s ease-out, transform 1.5s ease-out; */
    }

    @keyframes slidein {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .scroll-in {
        opacity: 0;
        transform: translateY(30px); /* Starting point for slide-in */
        transition: opacity 1.5s ease-out, transform 1.5s ease-out;
    }

    /* Triggered slide-in effect */
    .scroll-in-visible {
        opacity: 1;
        transform: translateX(0);
    }
  </style>
</head>
<body>

  <!-- Warning Message for Desktop Users -->
  <div class="desktop-warning">
    Please view this page on a mobile device.
  </div>
  <!-- Mobile Container -->
  <div class="mobile-container hide-on-desktop" id="container">
    <!-- Logo Image -->
    <img src="/assets/logo.png" alt="Motif Logo" class="logo fade-in">
    <img src="/assets/photo.png" alt="" class="photo slide-in" id="photo ">

    <div class="resultimage1 slide-in">
      <img src="/assets/casual.png" class="icon-img" id="i100" alt="Result Image 1" id="styleimg1">
      <img src="/assets/100.png" class="t100 page3" alt=" ">
    </div>
    <div class="resultimage2 slide-in">
      <img src="/assets/minimalist.png" class="icon-img" id="i50" alt="Result Image 2" id="styleimg2">
      <img src="/assets/50.png" class="t50 page3" alt=" ">
    </div>
    <div class="outfitNum fade-in" id="outfitNum">Outfit 000</div>
    <div class="analysis-result fade-in" id="analysisResult">Congrats! Youâ€™ve unlocked your signature styles!<br><br>Continue to view your best match fashion designer.</div>
    <img src="/assets/arrow.png" class="arrow fade-in" id="arrow">
  </div>


  <script>

    function checkScreenWidth() {
      if (window.innerWidth > 768) {
        document.querySelector('.desktop-warning').style.display = 'block';
        document.querySelector('.hide-on-desktop').style.display = 'none';
      } else {
        document.querySelector('.desktop-warning').style.display = 'none';
        document.querySelector('.hide-on-desktop').style.display = 'flex';
      }
    }

    // Initial check and resize event listener
    checkScreenWidth();
    window.addEventListener('resize', checkScreenWidth);

    var tags;
    var image;
    var comment;
    var imageNum;

    async function checkAndUploadPendingFiles() {
      // Retrieve pending files and tags from sessionStorage
      const pendingFiles = JSON.parse(sessionStorage.getItem('pendingUploadFilesNew'));
      const pendingTags = JSON.parse(sessionStorage.getItem('pendingUploadTagsNew'));
      const pendingComment = JSON.parse(sessionStorage.getItem('pendingUploadCommentNew'));
      imageNum = JSON.parse(sessionStorage.getItem('pendingUploadImageNum'));

      sessionStorage.removeItem('pendingUploadFilesNew');
      sessionStorage.removeItem('pendingUploadTagsNew');
      sessionStorage.removeItem('pendingUploadCommentNew');
      sessionStorage.removeItem('pendingUploadImageNum');
      console.log(pendingFiles);
      console.log(pendingTags);
      tags = pendingTags;
      comment = pendingComment;
      if (pendingFiles && pendingFiles.length > 0) {
        pendingFiles.forEach((file, index) => {
          image = base64ToBlob(file.data, file.type);
          console.log(image);
        });

        const reader = new FileReader();
        reader.onload = function(e) {
            document.getElementById(`photo`).src = image;
        };
        reader.readAsDataURL(image);
        
        const container = document.getElementById('container');

        document.getElementById(`i100`).src = `/assets/${tags[0]}.png`;
        document.getElementById(`i50`).src = `/assets/${tags[1]}.png`;
        document.getElementById('analysisResult').innerHTML = comment;
        const formattedImageNum = (imageNum + 1).toString().padStart(3, '0');
        document.getElementById('outfitNum').innerHTML = `Outfit ${formattedImageNum}`;

        const dateObj = new Date();
        const day = String(dateObj.getDate()).padStart(2, '0');
        const monthNames = ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"];
        const month = monthNames[dateObj.getMonth()];
        const datediv = document.createElement('div');
        datediv.classList.add('date');
        const daydiv = document.createElement('div');
        daydiv.classList.add('day');
        daydiv.textContent = day;
        const mondiv = document.createElement('div');
        mondiv.classList.add('month');
        mondiv.textContent = month;
        datediv.appendChild(daydiv);
        datediv.appendChild(mondiv);
        container.appendChild(datediv);
      }
    }

    // Helper function to convert base64 back to a Blob
    function base64ToBlob(base64, mimeType) {
      const byteString = atob(base64.split(',')[1]);
      const arrayBuffer = new ArrayBuffer(byteString.length);
      const uint8Array = new Uint8Array(arrayBuffer);
      for (let i = 0; i < byteString.length; i++) {
        uint8Array[i] = byteString.charCodeAt(i);
      }
      return new Blob([arrayBuffer], { type: mimeType });
    }

    // Call this function on the page after login (e.g., in home.html)
    window.onload = checkAndUploadPendingFiles();
    document.getElementById("arrow").addEventListener("click", function() {
        window.location.href = "/home";
    });
  </script>

</body>
</html>

